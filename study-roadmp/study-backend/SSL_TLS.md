# SSL과 TLS란?

## 개요

`SSL(Secure Sockets Layer)`과 `TLS(Transport Layer Security)`는  
웹 브라우저와 서버 간의 데이터를 암호화하여 **안전하게 통신**할 수 있도록 도와주는 보안 프로토콜이다.

이들은 네트워크 상에서 데이터를 전송할 때 **도청, 위조, 변조를 방지**하기 위해 사용된다.  
**HTTPS는 HTTP 위에 TLS를 얹은 프로토콜**이며, 웹에서 가장 일반적으로 사용되는 형태다.

> HTTPS는 애플리케이션 계층과 전송 계층사이에 신뢰 계층인 SSL/TLS 계층을 넣은 신뢰할 수 있는 HTTP 요청
---

## SSL과 TLS의 차이점

| 항목 | SSL | TLS |
|------|-----|-----|
| 개발 시기 | 1990년대 (Netscape) | 1999년 IETF 표준화 |
| 보안성 | 여러 보안 취약점 존재 | SSL보다 강력한 보안 |
| 사용 현황 | 더 이상 사용되지 않음 | 현재 표준 (TLS 1.2, TLS 1.3) |
| 예시 표현 | "SSL 인증서"로 표현되는 경우가 많지만 실제로는 TLS 사용 | 실제로 사용하는 프로토콜 |

---

## 작동 방식 (핸드셰이크 과정 포함)

SSL/TLS는 보안 세션을 기반으로 데이터를 암호화하며 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 암호화 알고리즘, 해싱 알고리즘이 사용됨

### 1. 클라이언트 Hello
- 클라이언트가 서버에 접속 요청을 보냄
- 지원하는 TLS 버전, 암호화 방식(cipher suite), 랜덤값 등을 포함

### 2. 서버 Hello
- 서버가 응답하며, TLS 버전 및 암호화 방식 선택
- 서버 인증서(공개키 포함) 전달
- 세션 ID, 랜덤값 포함

### 3. 서버 인증
- 클라이언트는 서버의 인증서를 검증함 (신뢰된 인증기관인지 등)

### 4. 키 교환
- 클라이언트는 Pre-Master Secret(임시 키)을 생성 후, 서버의 공개키로 암호화하여 서버에 전달
- 서버는 이를 복호화하여 세션 키를 생성

### 5. 세션 키 생성
- 양측이 같은 세션 키를 보유하게 되며, 이후 통신은 이 키로 암호화됨

### 6. 핸드셰이크 완료
- 모든 설정이 완료되었음을 확인하고, 암호화된 애플리케이션 데이터 통신이 시작됨

---

## 보안 특징

- **기밀성 (Confidentiality)**: 전송되는 데이터는 암호화되어 있어 제3자가 볼 수 없음
- **무결성 (Integrity)**: 데이터가 도중에 변조되지 않았음을 보장
- **인증 (Authentication)**: 서버(또는 클라이언트)의 신원을 확인할 수 있음

---

## 실생활 예시

- 브라우저 주소창에 🔒 자물쇠 표시 = TLS 암호화 적용
- HTTPS 접속 시 실제로는 TLS 프로토콜을 통해 통신 중
- 전자결제, 로그인, 이메일 송수신 등에서 필수적으로 사용

---

## 요약

> **SSL은 과거에 사용되던 암호화 프로토콜이고, TLS는 현재 사용되는 업그레이드된 표준 프로토콜이다.**  
> 오늘날의 HTTPS 통신은 모두 TLS 기반으로 동작하며, 사용자의 정보를 안전하게 보호하는 핵심 역할을 한다.

# CA (Certificate Authority)와 인증서 발급 과정

## CA란?

**CA(Certificate Authority, 인증 기관)**는  
인터넷에서 신원을 증명해주는 **공식적인 인증서 발급 기관**이다.  

브라우저나 운영체제는 **신뢰할 수 있는 CA 목록**을 내장하고 있으며,  
이 목록에 등록된 기관이 발급한 인증서를 신뢰한다.

---

## 인증서 발급 목적

- 웹사이트의 **신원을 보장**하고
- TLS 통신을 위한 **공개키 기반 암호화 체계(PKI)**를 가능하게 함

---

## 인증서 발급 흐름

### 1. 공개키/개인키 생성 (서버 측)
- 웹 서버 관리자가 **공개키와 개인키 쌍**을 생성

### 2. CSR 생성 (Certificate Signing Request)
- 공개키, 도메인 정보, 조직 정보 등을 담은 요청 파일
- 이 CSR을 CA에게 제출

### 3. CA가 요청 검증
- CA는 **도메인 소유자 인증(DNS, 이메일 등)** 또는 **기업 인증**을 통해 요청자 신원 확인

### 4. 인증서 발급
- CA는 요청이 합당하다고 판단되면, **인증서에 전자서명하여 발급**
- 이 인증서에는 **공개키, 유효 기간, 도메인, CA 서명 등**이 포함됨

### 5. 서버에 인증서 설치
- 발급받은 인증서를 웹 서버에 설치
- 이후 클라이언트가 접속 시 이 인증서로 TLS 핸드셰이크 수행

---

## 인증서 구성 요소

- 공개키
- 도메인 이름
- 유효 기간 (만료일)
- CA의 디지털 서명
- 발급 대상 정보 (회사 이름 등)

---

## 인증서 신뢰 체계 (체인 구조)

1. **서버 인증서**
2. **중간 인증서(Intermediate CA)** – 보통 루트 CA 대신 서명
3. **루트 인증서(Root CA)** – 브라우저/OS에 내장된 신뢰기관

> 인증서 체인은 루트까지 이어져야 브라우저가 "안전함"으로 인식함

---

## 무료 인증서 발급 예

- [Let's Encrypt](https://letsencrypt.org/)
- 자동화된 방식으로 빠르게 인증서 발급 가능 (유효기간 90일)

---

# TLS 핸드셰이크 작동 방식 (상세 예시)

## 개요

**SSL/TLS**는 보안 세션을 기반으로 데이터를 암호화하며,  
보안 세션이 만들어질 때 **인증 메커니즘, 키 교환 알고리즘, 해싱 알고리즘**이 사용된다.

이 문서는 **TLS 1.2 기준 핸드셰이크 작동 방식**을 예시와 함께 단계별로 정리한다.

---

## 시나리오 예시

- 사용자가 브라우저에서 `https://example.com` 접속
- 서버는 Let's Encrypt 인증서를 사용
- 통신은 TLS 1.2로 수행

---

## 핸드셰이크 단계별 흐름

### 1. 클라이언트 Hello

```plaintext
Client Hello:
  - 지원 TLS 버전: TLS 1.0, 1.1, 1.2
  - 지원 Cipher Suites: TLS_RSA_WITH_AES_128_CBC_SHA, ...
  - 클라이언트 랜덤값
  - SNI: example.com
```

> 브라우저는 서버에게 어떤 보안 설정을 지원하는지 알림

---

### 2. 서버 Hello

```plaintext
Server Hello:
  - 선택 TLS 버전: TLS 1.2
  - 선택 Cipher Suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
  - 서버 랜덤값
  - 서버 인증서 (공개키 포함)
```

> 서버는 선택한 설정과 함께 인증서를 전달

---

### 3. 서버 인증서 검증 (클라이언트 측)

브라우저는 서버가 보낸 인증서를 다음 기준으로 검증:

- 도메인 일치 여부 (CN, SAN)
- 유효 기간 확인
- 신뢰된 루트 CA를 통해 체인 검증
- OCSP/CRL로 인증서 폐기 여부 확인

---

### 4. 키 교환

클라이언트는 Pre-Master Secret을 생성하고, 서버 공개키로 암호화하여 전송

```plaintext
Client Key Exchange:
  - 암호화된 Pre-Master Secret 포함
```

서버는 자신의 개인키로 이를 복호화함

---

### 5. 세션 키 생성

클라이언트와 서버는 다음을 기반으로 동일한 세션 키를 생성:

- Pre-Master Secret
- 클라이언트 랜덤값
- 서버 랜덤값

파생된 키 예시:

```plaintext
- client_write_key, server_write_key
- client_write_MAC_key, server_write_MAC_key
```

---

### 6. ChangeCipherSpec + Finished

```plaintext
클라이언트:
  - ChangeCipherSpec (암호화 시작 선언)
  - Finished (암호화된 핸드셰이크 완료 정보)

서버:
  - ChangeCipherSpec
  - Finished
```

> 양측이 세션 키가 동일함을 서로 검증

---

### 7. 애플리케이션 데이터 전송

이제 모든 통신은 세션 키로 암호화된 상태에서 이루어짐:

- GET / 요청 → 암호화된 HTTP 요청
- HTML, JSON 응답 → 암호화된 콘텐츠

---

## 요약 테이블

| 단계 | 설명 |
|------|------|
| 1 | 클라이언트가 지원 버전/암호화 목록 전송 |
| 2 | 서버가 설정 선택 및 인증서 전달 |
| 3 | 클라이언트가 인증서 검증 |
| 4 | 클라이언트가 Pre-Master Secret 전송 |
| 5 | 서버와 클라이언트가 세션 키 생성 |
| 6 | 양측 암호화 모드 진입 및 확인 |
| 7 | 실제 HTTPS 통신 시작 (암호화된 데이터 교환) |


## 요약

> CA는 신뢰 기반 웹 보안을 가능하게 하는 인증 기관이며,  
> 인증서 발급은 공개키를 기반으로 도메인 소유를 검증하고 CA가 서명하는 과정을 통해 이루어진다.
