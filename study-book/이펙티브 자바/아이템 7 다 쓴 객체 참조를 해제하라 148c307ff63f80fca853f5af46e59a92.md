# 아이템 7: 다 쓴 객체 참조를 해제하라

**핵심 내용**

- 다 쓴 객체를 참조한 채로 두면 메모리 누수가 발생할 수 있음
- 객체 참조를 적시에 해제하여 GC가 제대로 메모리를 회수할 수 있도록 해야 함

**왜 다 쓴 객체 참조를 해제해야 하는가?**

- **GC 동작 원리**
    - Java의 GC는 더 이상 참조되지 않는 객체를 회수함
    - 그러나 필요 없는 객체를 참조로 계속 유지하면 GC가 이를 사용중이라고 판단, 메모리를 회수하지 않음
- 메모리 누수의 결과
    - 프로그램 실행 중 메모리가 점점 증가하여 OOM을 유발할 수 있음
    - 특히 Long-lived객체에서 문제가 발생하기 쉽다

**메모리 누수 방지를 위한 전략**

- 컬렉션 사용 시 참조 해제
    - 컬렉션에서 다 쓴 객체는 명시적으로 제거
    - 필요하면 WeakHashMap, SoftReference를 활용하여 참조를 관리
- 사용 범위가 명확한 객체
    - 객체의 생명 주기가 명확한 경우, 범위를 벗어날 때 참조를 해제
    - try-finally나 try-with-resources 사용
- Listener 및 callback 관리
    - 리스너나 콜백을 등록할 경우 반드시 제거 메서드를 제공
    - 약한 참조를 사용하여 리스너의 수명을 관리
- 사용이 끝난 필드 참조 해제
    - 인스턴스 필드에 사용이 끝난 객체를 명시적으로 null 설정

```java
public class Example {
    private Object field;

    public void clearField() {
        field = null; // 참조 해제
    }
}
```

### 요약

- 다 쓴 객체는 적시에 참조를 해제
    - 컬렉션, 캐시, 리스너 등에서 다 쓴 객체를 명시적으로 제거
- 약한 참조와 소프트 참조 활용
    - WeakReference와 SoftReference를 사용해 GC가 불필요한 객체를 회수하도록 도움.
- **자원 관리 자동화**
    - try-with-resources를 사용해 자원 관리.
- **메모리 누수 방지 습관**
    - 컬렉션 사용 시 clear(), 리스너 사용 시 제거 메서드 호출 등 **좋은 관리 습관**을 들이자.

### 약한 참조 (Weak Reference)란

- 약한 참조는 객체를 참조하지만 GC가 메모리 부족 상태를 감지했을 때, 해당 객체를 회수할 수 있도록 허용하는 참조 유형입니다
- 강한 참조와 달리, 약한 참조는 객체의 생명주기에 영향을 미치지 않습니다