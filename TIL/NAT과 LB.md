# NAT 관련 Q&A 정리

## ❓ Q1. NAT 주소를 외부에 공개할 때는 언제야?
> 외부서비스에서 우리 서비스 호출 시 NAT 주소를 전달했는데, 로드밸런서나 다른 public IP를 줘도 되는 거 아냐?

### ✅ A1.
NAT 주소를 외부에 공개한다는 건 보통 다음과 같은 상황입니다:

- 우리 서비스가 **외부 시스템에 접근**할 때, 상대 시스템이 **우리의 IP를 방화벽에 등록**해야 할 경우
- 이때 등록하는 IP는 **우리 서버가 외부에 나갈 때 사용하는 공인 IP (NAT IP)**입니다
- **로드밸런서 IP는 주로 인바운드**에 쓰이고, 아웃바운드 시에는 NAT IP가 사용되므로, 목적이 다릅니다

---

## ❓ Q2. 외부 서비스가 우리 서비스를 호출하는데 NAT 주소를 호출했다니까?

### ✅ A2.
이건 일반적인 로드밸런서를 통한 접근이 아닌, **NAT 장비에서 포트포워딩 또는 1:1 공인 IP 매핑이 된 경우**로 해석됩니다.

- 외부에서 `203.0.113.10:443` 같은 NAT IP를 호출하고,
- 내부의 특정 서버(예: `10.0.1.10:8080`)로 요청이 포워딩되는 구조일 수 있음
- 이 구조에서는 로드밸런서 없이 **방화벽/NAT 장비에서 직접 연결을 허용**함

---

## ❓ Q3. NAT에서 어떻게 포트포워딩을 해?

### ✅ A3.
NAT 장비 또는 리눅스 서버에서 포트포워딩(DNAT)은 다음과 같이 설정됩니다:

#### ▶ 리눅스 예시 (iptables)
```bash
# 외부 443 포트를 내부 8080 포트로 포워딩
iptables -t nat -A PREROUTING -p tcp --dport 443 -j DNAT --to-destination 10.0.1.23:8080
iptables -A FORWARD -p tcp -d 10.0.1.23 --dport 8080 -j ACCEPT
```

#### ▶ 필요 설정
```bash
# IP 포워딩 활성화
echo 1 > /proc/sys/net/ipv4/ip_forward
```

#### ▶ 클라우드에서?
- AWS NAT Gateway는 **Outbound 전용**
- Inbound 포트포워딩이 필요하면 **NAT 인스턴스 + iptables** 조합으로 구성해야 함

---

## ❓ Q4. NAT을 특정 서버(EC2)에만 붙였다면 포트포워딩은 상관없지?

### ✅ A4.
맞아요! **NAT IP를 EC2에 1:1로 붙였다면 포트포워딩은 필요 없습니다.**

- 해당 EC2가 곧 공인 IP를 가지게 되는 것이고,
- 외부에서 `NAT_IP:PORT`로 요청 시 EC2가 직접 응답하게 됩니다
- 단, **보안그룹 / OS 방화벽 / 애플리케이션 바인딩 포트**는 잘 설정돼 있어야 함

---

## ❓ Q5. 그럼 인터널 서버를 외부로 공개하고 싶은데, ALB와 같은 공개주소 로드밸런서를 띄우기 싫을 때 NAT을 써도 되는 거야?

### ✅ A5.
Yes, 가능합니다!  
**NAT IP를 EC2에 직접 바인딩하여 외부 공개**하면, ALB 없이도 외부 접근이 가능합니다.

### 하지만 주의:
| 항목 | NAT 직접 노출 | ALB 사용 |
|------|----------------|-----------|
| TLS 종료 | 서버에서 직접 해야 함 | ALB가 처리 가능 |
| 보안 | 직접 방어 필요 | WAF, 인증, 로그 등 통합 |
| 확장성 | 수동 확장 | 자동 확장 가능 |
| 비용 | 저렴 (ALB 비용 없음) | 추가 비용 있음 |

**따라서 테스트/개발 환경이나 단일 서버 운영에는 적합**하지만,  
**실서비스라면 보안/운영 부담 고려해서 ALB 사용하는 게 일반적입니다.**
